p7 <- ggplot(rw_df, aes(x= SECshort, y=ks4score)) + geom_boxplot()
p8 <- ggplot(rw_df, aes(x= hiquamum, y=ks4score)) + geom_boxplot()
p9 <- ggplot(rw_df, aes(x= singlepar, y=ks4score)) + geom_boxplot()
p10 <- ggplot(rw_df, aes(x= house, y=ks4score)) + geom_boxplot()
p11 <- ggplot(rw_df, aes(x= fsm, y=ks4score)) + geom_boxplot()
p12 <- ggplot(rw_df, aes(x= parasp, y=ks4score)) + geom_boxplot()
grid.arrange(p1, p2, p3, p4, ncol =2, nrow=2)
grid.arrange(p5, p6, p9, p10, p11, p12, ncol =3, nrow=2)
p7 <- p7 +  theme(axis.text.x = element_text(angle = 30, vjust = 1, hjust=1))
p8 <- p8 + theme(axis.text.x = element_text(angle = 30, vjust = 1, hjust=1))
grid.arrange( p7, p8, ncol =2, nrow=1)
model_1 <- lm(ks4score ~ fiveem + fiveac + factor(k3en) + factor(k3ma) + factor(k3sc) + gender + new_secshort + new_hiquamum + singlepar + house + fsm + parasp, data=mani_df)
model_1 <- lm(ks4score ~ fiveem + fiveac + factor(k3en) + factor(k3ma) + factor(k3sc) + gender + SECshort + hiquamum + singlepar + house + fsm + parasp, data=rw_df)
Anova(model_1)
```{r}
model_2 <- lm(ks4score ~ fiveem + fiveac + factor(k3en) + factor(k3ma) + factor(k3sc)  + gender + new_hiquamum + singlepar + house + fsm + parasp, data=mani_df)
Anova(model_2)
```
remove new_hiquamum from the model
```{r}
model_2 <- lm(ks4score ~ fiveem + fiveac + factor(k3en) + factor(k3ma) + factor(k3sc)  + gender + hiquamum + singlepar + house + fsm + parasp, data=rw_df)
Anova(model_2)
```
remove new_hiquamum from the model
```{r}
model_3 <- lm(ks4score ~ fiveem + fiveac + factor(k3en) + factor(k3ma) + factor(k3sc) + hiquamum + gender + singlepar + house + parasp, data=mani_df)
```{r}
model_3 <- lm(ks4score ~ fiveem + fiveac + factor(k3en) + factor(k3ma) + factor(k3sc) + hiquamum + gender + singlepar + house + parasp, data=rw_df)
Anova(model_3)
```
remove fsm
Anova(model_3)
vif(model_3)
```
```{r}
model_4 <- lm(ks4score ~ fiveem + fiveac + factor(k3en) + factor(k3ma)  + gender + singlepar + house + parasp, data=mani_df)
```{r}
model_4 <- lm(ks4score ~ fiveem + fiveac + factor(k3en) + factor(k3ma)  + gender + singlepar + house + parasp, data=rw_df)
Anova(model_4)
```
```{r}
model_4 <- lm(ks4score ~ fiveem + fiveac + factor(k3en) + factor(k3ma)  + gender + singlepar + house + parasp + hiquamum, data=rw_df)
Anova(model_4)
```
```{r}
vif(model_4)
summary(model_4)
```
```{r}
model_4 <- lm(ks4score ~ fiveem + fiveac + factor(k3en) + factor(k3ma)+ factor(k3sc)  + gender + singlepar + house + parasp + hiquamum, data=rw_df)
Anova(model_4)
```
```{r}
vif(model_4)
summary(model_4)
```
```{r}
model_7 <- lm(ks4score ~ fiveem + factor(k3en) + factor(k3ma)  + gender + singlepar + house + parasp, data=mani_df)
```{r}
model_5 <- lm(ks4score ~ fiveem + factor(k3en) + factor(k3ma)  + gender + singlepar + house + parasp, data=mani_df)
vif(model_5)
summary(model_5)
```
```{r}
model_5 <- lm(ks4score ~ fiveem + factor(k3en) + factor(k3ma)  + gender + singlepar + house + parasp, data=rw_df)
vif(model_5)
```{r}
model_5 <- lm(ks4score ~ fiveem + factor(k3en) + gender + singlepar + house + parasp, data=rw_df)
vif(model_5)
summary(model_5)
```
```{r}
mani_df <- rw_df
mani_df$new_secshort <- rw_df$SECshort
levels(mani_df$new_secshort)[levels(mani_df$new_secshort) %in% c("Intermediate","Routine,_semi-routine_or_unemployed")] <- "non-professional"
levels(mani_df$new_secshort)[levels(mani_df$new_secshort) %in% c("Managerial_and_professional")] <- "professional"
mani_df$new_secshort <- factor(mani_df$new_secshort, ordered = FALSE)
mani_df$new_secshort <- relevel(mani_df$new_secshort , ref="non-professional")
View(mani_df)
```{r}
mani_df <- rw_df
mani_df$new_secshort <- rw_df$SECshort
levels(mani_df$new_secshort)[levels(mani_df$new_secshort) %in% c("Intermediate","Routine,_semi-routine_or_unemployed")] <- "non-professional"
levels(mani_df$new_secshort)[levels(mani_df$new_secshort) %in% c("Managerial_and_professional")] <- "professional"
mani_df$new_secshort <- factor(mani_df$new_secshort, ordered = FALSE)
mani_df$new_secshort <- relevel(mani_df$new_secshort , ref="non-professional")
levels(mani_df$new_secshort)[levels(mani_df$new_secshort) %in% c("Intermediate","Routine,_semi-routine_or_unemployed")] <- "non-professional"
levels(mani_df$new_secshort)[levels(mani_df$new_secshort) %in% c("Managerial_and_professional")] <- "professional"
mani_df$new_secshort <- relevel(mani_df$new_secshort , ref="non-professional")
summary(mani_df$new_secshort)
```
```{r}
mani_df$new_hiquamum <- mani_df$hiquamum
mani_df$new_hiquamum <- factor(mani_df$new_hiquamum, ordered = FALSE)
levels(mani_df$new_hiquamum)[levels(mani_df$new_hiquamum) %in% c("No_qualification","Other_qualifications","GCSE_grades_A-C_or_equiv","GCE_A_Level_or_equivalent","HE_below_degree_level")] <- "no-degree"
levels(mani_df$new_hiquamum)[levels(mani_df$new_hiquamum) %in% c("Degree_or_equivalent")] <- "degree-equivalent"
mani_df$new_hiquamum <- relevel(mani_df$new_hiquamum, ref="no-degree")
summary(mani_df$new_hiquamum)
```
```{r}
missing <- sum(rw_df$singlepar == "missing")
110/13589
model_1 <- lm(ks4score ~ fiveem + fiveac + factor(k3en) + factor(k3ma) + factor(k3sc) + gender + new_secshort + new_hiquamum + singlepar + house + fsm + parasp, data=mani_df)
Anova(model_1)
```
```{r}
model_2 <- lm(ks4score ~ fiveem + fiveac + factor(k3en) + factor(k3ma) + factor(k3sc) + gender + new_hiquamum + singlepar + house + fsm + parasp, data=mani_df)
Anova(model_2)
```
remove fsm from the model
```{r}
model_2 <- lm(ks4score ~ fiveem + fiveac + factor(k3en) + factor(k3ma) + factor(k3sc) + gender + new_hiquamum + singlepar + house + fsm + parasp, data=mani_df)
Anova(model_2)
```
```{r}
model_3 <- lm(ks4score ~ fiveem + fiveac + factor(k3en) + factor(k3ma) + factor(k3sc) + hiquamum + gender + singlepar + house + parasp, data=rw_df)
```{r}
model_3 <- lm(ks4score ~ fiveem + fiveac + factor(k3en) + factor(k3ma) + factor(k3sc) + gender + singlepar + house + fsm + parasp, data=mani_df)
Anova(model_3)
remove fsm
```{r}
model_4 <- lm(ks4score ~ fiveem + fiveac + factor(k3en) + factor(k3ma) + factor(k3sc) + gender + singlepar + house + parasp, data=mani_df)
Anova(model_3)
Anova(model_4)
vif(model_4)
```
remove k3sc because highly correlated with k3ma
```{r}
model_5 <- lm(ks4score ~ fiveem + fiveac + factor(k3en) + factor(k3ma)  + gender + singlepar + house + parasp, data=rw_df)
Anova(model_5)
```
vif(model_5)
```
vif(model_6)
K3ma and k3sc have high VIF values, 11.67 and 12.9 respectively indicating a problematic amount of colinearity.
remove k3sc because highly correlated with k3ma
```{r}
model_5 <- lm(ks4score ~ fiveem + fiveac + factor(k3en) + factor(k3ma)  + gender + singlepar + house + parasp, data=mani_df)
vif(model_5)
```
model_6 <- lm(ks4score ~ fiveac + factor(k3en) + gender + singlepar + house + parasp, data=mani_df)
vif(model_6)
summary(model_6)
```
display(model_6)
```
library(car)
library(ggplot2)
study_habits <- read.csv("stats_study_habits.csv", , header = TRUE,stringsAsFactors = TRUE)
study_habits <- read.csv("Stats_study_habits.csv", , header = TRUE,stringsAsFactors = TRUE)
study_habits <- read.csv("Stats_study_habits.csv", , header = TRUE,stringsAsFactors = TRUE)
setwd("~/GitHub/Rstudio/ST211/Week 5")
study_habits <- read.csv("Stats_study_habits.csv", , header = TRUE,stringsAsFactors = TRUE)
grade.lm.2<-lm(Grade~Study.Skills*factor(Interesting),data=study_habits)
display(grade.lm.2)
display(grade.lm.2)
library(arm)
display(grade.lm.2)
#plot the linear model
p1<-ggplot(Study_habits, aes(x=study.Skills, y=Grade,  color=factor(Interesting)))
p1<- p1 + geom_point(size=2)
#plot the linear model
p1<-ggplot(study_habits, aes(x=Study.Skills, y=Grade,  color=factor(Interesting)))
p1<- p1 + geom_point(size=2)
p1<-p1+geom_smooth(method="lm", se=FALSE)
#legend
p1<-p1+scale_colour_discrete(name  ="Interesting",
breaks=c("0", "1"),
labels=c("No", "Yes"))
p1
p2<-ggplot(Study_habits, aes(x=Study.Skills, y=Grade,  color=factor(Interesting)))
p2<-ggplot(study_habits, aes(x=Study.Skills, y=Grade,  color=factor(Interesting)))
p2<- p2 + geom_point(size=2)
p2<-p2+geom_smooth(method="lm", se=FALSE)
#legend
p2<-p2+scale_colour_discrete(name  ="Interesting",
breaks=c("0", "1"),
labels=c("No", "Yes"))
p2
p2<-ggplot(study_habits, aes(x=Study.Skills, y=Grade, shape=factor(Interesting), color=factor(Interesting)))
p2<- p2 + geom_point(size=2)  + theme_bw()
p2<-p2+geom_smooth(method="lm", se=FALSE)
p2<-p2+scale_colour_grey(name  ="Interesting",
breaks=c("0", "1"),
labels=c("No", "Yes"))
p2<-p2+scale_shape_discrete(name  ="Interesting",
breaks=c("0", "1"),
labels=c("No", "Yes"))
p2
#checking the outliers
out.1<-which(Study_habits$Grade==min(Study_habits$Grade))
#checking the outliers
out.1<-which(study_habits$Grade==min(Study_habits$Grade))
out.2<-with(study_habits, which(Grade<60 & Study.Skills<10))
out.3<-with(study_habits, which(Grade>60 & Study.Skills<15))
#checking the outliers
out.1<-which(study_habits$Grade==min(study_habits$Grade))
out.2<-with(study_habits, which(Grade<60 & Study.Skills<10))
out.3<-with(study_habits, which(Grade>60 & Study.Skills<15))
study_habits[c(out.1,out.2,out.3),c(2,7,8)]
#display regression with outlier removal
Study_habits.out.1<-study_habits[-out.1,]
grade.lm.no.out<-lm(Grade~Study.Skills*factor(Interesting),data=Study_habits.out.1)
display(grade.lm.no.out)
#plot the visual
p3<-ggplot(study_habits, aes(x=Study.Skills, y=Grade,  color=factor(Interesting)))
p3<- p3 + geom_point(size=2)
p3<- p3 + geom_point(data=study_habits[out.1,], color="black")
p3<-p3+geom_smooth(method="lm", se=FALSE)
p3<-p3+scale_colour_discrete(name  ="Interesting",
breaks=c("0", "1"),
labels=c("No", "Yes"))
p3<-ggplot()+ geom_smooth(data=Study_habits.out.1, aes(x=Study.Skills, y=Grade,  color=factor(Interesting)), method = "lm",se=FALSE, linetype="dashed")
p3
#plot the visual
p3<-ggplot(study_habits, aes(x=Study.Skills, y=Grade,  color=factor(Interesting)))
p3<- p3 + geom_point(size=2)
p3<- p3 + geom_point(data=study_habits[out.1,], color="black")
p3<-p3+geom_smooth(method="lm", se=FALSE)
p3<-p3+scale_colour_discrete(name  ="Interesting",
breaks=c("0", "1"),
labels=c("No", "Yes"))
p3<-ggplot()+ geom_smooth(data=Study_habits.out.1, aes(x=Study.Skills, y=Grade,  color=factor(Interesting)), method = "lm",se=FALSE, linetype="dashed")
p3
#plot the visual
p3<-ggplot(study_habits, aes(x=Study.Skills, y=Grade,  color=factor(Interesting)))
p3
View(study_habits)
View(study_habits)
#plot the visual
p3<-ggplot(study_habits, aes(x=Study.Skills, y=Grade,  color=factor(Interesting)))
p3<- p3 + geom_point(size=2)
p3
p3<- p3 + geom_point(data=study_habits[out.1,], color="black")
p3
p3<-p3+geom_smooth(method="lm", se=FALSE)
p3
p3<-p3+scale_colour_discrete(name  ="Interesting",
breaks=c("0", "1"),
labels=c("No", "Yes"))
p3<-p3+ geom_smooth(data=Study_habits.out.1, aes(x=Study.Skills, y=Grade,  color=factor(Interesting)), method = "lm",se=FALSE, linetype="dashed")
p3
p3<- p3 + geom_point(size=2) + theme_bw()
p3
Study_habits.out.1<-study_habits[-out.1,]
p1<-ggplot(study_habits, aes(x=Study.Skills, y=Grade, shape=factor(Interesting), color=factor(Interesting)))  + labs(tag = "A")
p1<- p1 + geom_point(size=2)
p1<- p1 + geom_point(data=study_habits[out.1,], shape=5, size=3)
p1<-p1+geom_smooth(method="lm", se=FALSE)+ theme_bw()+theme(legend.position = "none")
p1<-p1+scale_colour_grey(name  ="Interesting",
breaks=c("0", "1"),
labels=c("No", "Yes"))
p1<-p1+scale_shape_discrete(name  ="Interesting",
breaks=c("0", "1"),
labels=c("No", "Yes"))
p1
p4<-ggplot(study_habits, aes(x=Study.Skills, y=Grade, shape=factor(Interesting), color=factor(Interesting))) + labs(tag = "B")
p4<- p4 + geom_point(data=study_habits[out.2,], size=3, shape=5)
p4<- p4 + geom_point(size=2)
p4<-p4+geom_smooth(method="lm", se=FALSE)+ theme_bw()+theme(legend.position = "none")
p4<-p4+scale_colour_grey(name  ="Interesting",
breaks=c("0", "1"),
labels=c("No", "Yes"))
p4<-p4+scale_shape_discrete(name  ="Interesting",
breaks=c("0", "1"),
labels=c("No", "Yes"))
p4
#Outlier Statistics
Hourly_Pay<-read.csv("Large_Hourly_Pay.csv",header=TRUE, row.names = NULL)
HP.lm<-lm(log(hourpay)~age+factor(gender)+HighestQual,data=Hourly_Pay)
display(HP.lm)
ggplot(Hourly_Pay, aes(x=age,y=log(hourpay)))+geom_point()
HP.out<-show_outliers(HP.lm,10)
show_outliers<-function(the.linear.model,topN){
#length of data
n=length(fitted(the.linear.model))
#number of parameters estimated
p=length(coef(the.linear.model))
#standardised residuals over 3
res.out<-which(abs(rstandard(the.linear.model))>3) #sometimes >2
#topN values
res.top<-head(rev(sort(abs(rstandard(the.linear.model)))),topN)
#high leverage values
lev.out<-which(lm.influence(the.linear.model)$hat>2*p/n)
#topN values
lev.top<-head(rev(sort(lm.influence(the.linear.model)$hat)),topN)
#high diffits
dffits.out<-which(dffits(the.linear.model)>2*sqrt(p/n))
#topN values
dffits.top<-head(rev(sort(dffits(the.linear.model))),topN)
#Cook's over 1
cooks.out<-which(cooks.distance(the.linear.model)>1)
#topN cooks
cooks.top<-head(rev(sort(cooks.distance(the.linear.model))),topN)
#Create a list with the statistics -- cant do a data frame as different lengths
list.of.stats<-list(Std.res=res.out,Std.res.top=res.top, Leverage=lev.out, Leverage.top=lev.top, DFFITS=dffits.out, DFFITS.top=dffits.top, Cooks=cooks.out,Cooks.top=cooks.top)
#return the statistics
list.of.stats}
HP.out<-show_outliers(HP.lm,10)
head(hp.out, 5)
head(HP.out, 5)
print("Standardised residuals")
HP.out$Std.res.top
print("Leverage values")
HP.out$Leverage.top
print("DFFITS")
HP.out$DFFITS.top
print("Cook's d")
HP.out$Cooks.top
common.out<-intersect(intersect(HP.out$Std.res,HP.out$DFFITS),HP.out$Leverage)
common.out
View(HP.out)
View(HP.out)
library(car)
library(ggplot2)
library(arm)
nursery_dt <- read.table("NurserySchools.txt")
head(nursery_dt, 5)
library(gridExtra)
p1 <- ggplot(data = nursery_dt, aes(x=Dep, y= NurseryExp)) + geom_point() + geom_smooth(method = "lm")
p2 <- ggplot(data = nursery_dt, aes(x=NurseryProv , y= NurseryExp)) + geom_point() + geom_smooth(method = "lm")
grid.arrange(p1,p2,nrow=1)
p1 <- ggplot(data = nursery_dt, aes(x=Dep, y= NurseryExp)) + geom_point() + geom_smooth(method = "lm")
p2 <- ggplot(data = nursery_dt, aes(x=NurseryProv , y= NurseryExp)) + geom_point() + geom_smooth(method = "lm")
grid.arrange(p1,p2,nrow=1)
p1
p1 <- p1 + geom_smooth(method = "lm")
p1
p1 <- ggplot(data = nursery_dt, aes(x=Dep, y= NurseryExp)) + geom_point()
p1 <- p1 + geom_smooth(method = "lm")
p1
with(nursery_dt, cor(Dep, NurseryExp))
with(nursery_dt, cor(Dep, NurseryExp))
View(nursery_dt)
#load the data
nursery_dt <- read.table("NurserySchools.txt", header = TRUE)
head(nursery_dt, 5)
p1 <- ggplot(data = nursery_dt, aes(x=Dep, y= NurseryExp)) + geom_point() + geom_smooth(method = "lm")
p2 <- ggplot(data = nursery_dt, aes(x=NurseryProv , y= NurseryExp)) + geom_point() + geom_smooth(method = "lm")
grid.arrange(p1,p2,nrow=1)
with(nursery_dt, cor(Dep, NurseryExp))
with(nursery_dt, cor(NurseryProv,NurseryExp))
#Q2 remove outlies (max)
out1 <- which(nursery_df$NurseryExp==max(nursery_df$NurseryExp))
first_lm <- lm(NurseryExp ~ Dep + NurseryProv , data = nursery_df)
first_lm <- lm(NurseryExp ~ Dep + NurseryProv , data = nursery_dt)
display(first_lm)
nursery_out.1 <- nursery_dt[-out1,]
imp_first <- lm(NurseryExp ~ Dep + NurseryProv , data = nursery_out.1)
nursery_out.1 <- nursery_dt[-out1,]
#Q2 remove outlies (max)
out1 <- which(nursery_df$NurseryExp==max(nursery_df$NurseryExp))
#Q2 remove outlies (max)
out1 <- which(nursery_dt$NurseryExp==max(nursery_df$NurseryExp))
#Q2 remove outlies (max)
out1 <- which(nursery_dt$NurseryExp==max(nursery_dt$NurseryExp))
first_lm <- lm(NurseryExp ~ Dep + NurseryProv , data = nursery_dt)
display(first_lm)
nursery_out.1 <- nursery_dt[-out1,]
imp_first <- lm(NurseryExp ~ Dep + NurseryProv , data = nursery_out.1)
display(imp_first)
(15.85-14.81)/15.85
outliers.nursery <- show_outliers(first_lm, 5)
influtial.1 <- interact(outliers.nursery$DFFITS.top,outliers.nursery$Leverage.top)
influtial.1 <- intersect(outliers.nursery$DFFITS.top,outliers.nursery$Leverage.top)
influtial.1
first_lm <- lm(NurseryExp ~ Dep + NurseryProv , data = nursery_dt)
outliers.nursery <- show_outliers(first_lm, 5)
influtial.1 <- intersect(outliers.nursery$DFFITS.top,outliers.nursery$Leverage.top)
influtial.1
outliers.nursery$DFFITS.top
outliers.nursery$Leverage.top
nursery_dt[c(18, 28),]
nursery_dt[c(18, 28),][,4]
outliers.nursery <- show_outliers(first_lm, 5)
influtial.1 <- intersect(outliers.nursery$DFFITS.top,outliers.nursery$Leverage.top)
influtial.1
influtial.1 <- intersect(outliers.nursery$DFFITS.top,outliers.nursery$Leverage.top)
influtial.1
influtial.1 <- intersect(outliers.nursery$DFFITS,outliers.nursery$Leverage)
influtial.1
outliers.nursery$DFFITS
library(car)
library(arm)
library(ggplot2)
library(gridExtra)
setwd("~/GitHub/Rstudio/ST211/week 6")
rw.data <- read.csv("RWNS_final.csv", header = TRUE,stringsAsFactors = TRUE)
head(rw.data)
summary(rw.data)
p1 <- ggplot(rw.data, aes(x= fiveem, y=ks4score)) + geom_boxplot()
#duplicate data
new.rw.data <- rw.data
##---homework
new.rw.data$new_homework <- new.rw.data$homework
levels(new.rw.data$new_homework)[levels(new.rw.data$new_homework)%in%
c("none","1_evening","2_evenings")] <- "low"
levels(new.rw.data$new_homework)[levels(new.rw.data$new_homework)%in%
c("3_evenings","4_evenings","5_evenings")] <- "high"
summary(new.rw.data$new_homework)
p25<-ggplot(new.rw.data, aes(x=new_homework, y=ks4score)) + geom_boxplot()
##---attitude
new.rw.data$new_attitude <- new.rw.data$attitude
levels(new.rw.data$new_attitude)[levels(new.rw.data$new_attitude)%in%
c("low","very_low")] <- "low"
levels(new.rw.data$new_attitude)[levels(new.rw.data$new_attitude)%in%
c("high","very_high")] <- "high"
summary(new.rw.data$new_attitude)
p27<-ggplot(new.rw.data, aes(x=new_attitude, y=ks4score)) + geom_boxplot()
##---k3ma, k3en and k3sc
cor(new.rw.data$k3en,new.rw.data$k3ma)
cor(new.rw.data$k3en,new.rw.data$k3sc)
cor(new.rw.data$k3sc,new.rw.data$k3ma)
meank3s <- (new.rw.data$k3en+new.rw.data$k3ma+new.rw.data$k3sc)/3
table(meank3s)
meank3s <- as.factor(meank3s)
new.rw.data$meank3s <- meank3s
summary(new.rw.data)
new.rw.data$new_meank3s <- new.rw.data$meank3s
levels(new.rw.data$new_meank3s)[levels(new.rw.data$new_meank3s)%in%
c("2.33333333333333","2.66666666666667","3","3.33333333333333","3.66666666666667")] <- "low"
levels(new.rw.data$new_meank3s)[levels(new.rw.data$new_meank3s)%in%
c("4","4.33333333333333","4.66666666666667","5","5.33333333333333","5.66666666666667")] <- "medium"
levels(new.rw.data$new_meank3s)[levels(new.rw.data$new_meank3s)%in%
c("6","6.33333333333333","6.66666666666667","7","7.33333333333333")] <- "high"
summary(new.rw.data$new_meank3s)
##---FSMband
new.rw.data$new_FSMband <- new.rw.data$FSMband
levels(new.rw.data$new_FSMband)[levels(new.rw.data$new_FSMband)%in%
c("<5pr","5pr-9pr","9pr-13pr")] <- "low"
levels(new.rw.data$new_FSMband)[levels(new.rw.data$new_FSMband)%in%
c("13pr-21pr","21pr-35pr","35pr+")] <- "high"
summary(new.rw.data$new_FSMband)
p28<-ggplot(new.rw.data, aes(x=new_FSMband, y=ks4score)) + geom_boxplot()
##---SECshort
new.rw.data$new_secshort <- new.rw.data$SECshort
levels(new.rw.data$new_secshort)[levels(new.rw.data$new_secshort) %in% c("Intermediate","Routine,_semi-routine_or_unemployed")] <- "non-professional"
levels(new.rw.data$new_secshort)[levels(new.rw.data$new_secshort) %in% c("Managerial_and_professional")] <- "professional"
summary(new.rw.data$new_secshort)
p29<-ggplot(new.rw.data, aes(x=new_secshort, y=ks4score)) + geom_boxplot()
##---hiquamum
new.rw.data$new_hiquamum <- new.rw.data$hiquamum
levels(new.rw.data$new_hiquamum)[levels(new.rw.data$new_hiquamum) %in% c("GCE_A_Level_or_equivalent","HE_below_degree_level")] <- "Pre-university-equivalent"
summary(new.rw.data$new_hiquamum)
grid.arrange(p25, p27, p24, p28, ncol =2, nrow=2)
##----change the baselines
new.rw.data$SECshort <- relevel(new.rw.data$new_secshort, ref = "non-professional")
new.rw.data$hiqumum <- relevel(new.rw.data$new_hiquamum, ref = "No_qualification")
new.rw.data$singlepar <- relevel(new.rw.data$singlepar, ref = "yes")
new.rw.data$house <- relevel(new.rw.data$house, ref = "rented")
new.rw.data$fsm <- relevel(new.rw.data$fsm, ref = "yes")
new.rw.data$parasp <- relevel(new.rw.data$parasp, ref = "No")
new.rw.data$computer <- relevel(new.rw.data$computer, ref = "No")
new.rw.data$tuition <- relevel(new.rw.data$tuition, ref = "No")
new.rw.data$homework <- relevel(new.rw.data$homework, ref = "none")
new.rw.data$attitude <- relevel(new.rw.data$attitude, ref = "very_low")
new.rw.data$sen <- relevel(new.rw.data$sen, ref = "Yes")
new.rw.data$truancy <- relevel(new.rw.data$truancy, ref = "Yes")
new.rw.data$absent <- relevel(new.rw.data$absent, ref = "Yes")
new.rw.data$exclude <- relevel(new.rw.data$exclude, ref = "Yes")
new.rw.data$FSMband <- relevel(new.rw.data$new_FSMband, ref = "low")
##---first regression
ks4score.all.lm <-lm(ks4score ~ factor(fiveac)+factor(fiveem)
+ k3en + k3ma + k3sc
+factor(gender)+factor(new_secshort)+factor(new_hiquamum)
+factor(singlepar)+factor(house)+factor(fsm)
+factor(parasp)+factor(computer)+factor(tuition)+factor(pupasp)
+factor(new_homework)+factor(new_attitude)+factor(sen)+factor(truancy)
+factor(absent)+factor(exclude)+IDACI_n+factor(new_FSMband)
,data=new.rw.data)
Anova(ks4score.all.lm)
##---first regression
ks4score.all.lm <-lm(ks4score ~ factor(fiveac)+factor(fiveem)
+ k3en + k3ma + k3sc
+factor(gender)+factor(new_secshort)+factor(new_hiquamum)
+factor(singlepar)+factor(house)+factor(fsm)
+factor(parasp)+factor(computer)+factor(tuition)+factor(pupasp)
+factor(new_homework)+factor(new_attitude)+factor(sen)+factor(truancy)
+factor(absent)+factor(exclude)+IDACI_n+factor(new_FSMband)
,data=new.rw.data)
p1 <- ggplot(rw.data, aes(x= fiveem, y=ks4score)) + geom_boxplot()
p2 <- ggplot(rw.data, aes(x= fiveac, y=ks4score)) + geom_boxplot()
p3 <- ggplot(rw.data, aes(x= factor(k3en), y=ks4score)) + geom_boxplot() + labs(x="English Score Tier")
p4 <- ggplot(rw.data, aes(x= factor(k3ma), y=ks4score)) + geom_boxplot() + labs(x="Maths Score Tier")
p5 <- ggplot(rw.data, aes(x= factor(k3sc), y=ks4score)) + geom_boxplot() +  labs(x="Science Score Tier")
p6 <- ggplot(rw.data, aes(x= gender, y=ks4score)) + geom_boxplot()
p7 <- ggplot(rw.data, aes(x= SECshort, y=ks4score)) + geom_boxplot()
p8 <- ggplot(rw.data, aes(x= hiquamum, y=ks4score)) + geom_boxplot()
p9 <- ggplot(rw.data, aes(x= singlepar, y=ks4score)) + geom_boxplot()
p10 <- ggplot(rw.data, aes(x= house, y=ks4score)) + geom_boxplot()
p11 <- ggplot(rw.data, aes(x= fsm, y=ks4score)) + geom_boxplot()
p12 <- ggplot(rw.data, aes(x= parasp, y=ks4score)) + geom_boxplot()
p13<-ggplot(rw.data, aes(x=computer, y=ks4score)) + geom_boxplot()
p14<-ggplot(rw.data, aes(x=tuition, y=ks4score)) + geom_boxplot()
p15<-ggplot(rw.data, aes(x=pupasp, y=ks4score)) + geom_boxplot()
p16<-ggplot(rw.data, aes(x=homework, y=ks4score)) + geom_boxplot()
p17<-ggplot(rw.data, aes(x=attitude, y=ks4score)) + geom_boxplot()
p18<-ggplot(rw.data, aes(x=sen, y=ks4score)) + geom_boxplot()
p19<-ggplot(rw.data, aes(x=truancy, y=ks4score)) + geom_boxplot()
p20<-ggplot(rw.data, aes(x=absent, y=ks4score)) + geom_boxplot()
p21<-ggplot(rw.data, aes(x=exclude, y=ks4score)) + geom_boxplot()
p22<-ggplot(rw.data, aes(x=IDACI_n, y=ks4score)) + geom_point()
p23<-ggplot(rw.data, aes(x=FSMband, y=ks4score)) + geom_boxplot()
p7 <- p7 +  theme(axis.text.x = element_text(angle = 30, vjust = 1, hjust=1))
p8 <- p8 + theme(axis.text.x = element_text(angle = 30, vjust = 1, hjust=1))
grid.arrange( p7, p8, ncol =2, nrow=1)
grid.arrange(p1, p2, p3, p4, ncol =2, nrow=2)
grid.arrange(p5, p6, p9, p10,p11,p12, ncol =3, nrow=2)
grid.arrange(p13,p14,p15,nrow=2)
grid.arrange(p16,nrow=1)
grid.arrange(p17,p21,p19,p20,nrow=2)
grid.arrange(p18,p22,p23,nrow=2)
